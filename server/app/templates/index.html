{% extends "base.html" %}
{% block content %}
<style>
    .report-container {
        padding: 150px;
        max-width: 1200px;
        margin: auto;
        text-align: center;
    }

    h1 {
        font-size: 2.5em;
        margin-bottom: 20px;
        color: #333;
    }

    h2 {
        font-size: 2em;
        margin-top: 30px;
        color: #555;
    }

    p {
        font-size: 1.2em;
        margin-top: 10px;
        color: #666;
    }

    .chart-container {
        width: 100%;
        max-width: 800px;
        margin: 30px auto;
        text-align: center;
    }

    .score-container {
        margin-top: 30px;
    }

    .score {
        display: inline-block;
        padding: 20px;
        border-radius: 10px;
        font-size: 24px;
        color: white;
        font-weight: bold;
        width: 200px;
    }

    .low {
        background-color: #4caf50;
        /* Green */
    }

    .moderate {
        background-color: #ffeb3b;
        /* Yellow */
        color: #000;
    }

    .high {
        background-color: #f44336;
        /* Red */
    }

    .activity-summary {
        background-color: #f9f9f9;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        margin: 30px auto;
        text-align: center;
        max-width: 800px;
    }

    .activity-image {
        width: 400px;
        height: 200px;
        margin: 10px auto;
    }
</style>

<div class="report-container">
    <div class="activity-summary">
        <h2>üêåPest Activity Levelüêå</h2>
        <img src="{{ url_for('get_image', filename=pest_activity_level + '_pest.png') }}" class="activity-image">
        <p>Number of Pests: {{ num_pests }}</p>
        <h2>üêûBeneficial Insects Activity Levelüêû</h2>
        <img src="{{ url_for('get_image', filename=friend_activity_level + '.png') }}" class="activity-image">
        <p>Number of Friends: {{ num_friends }}</p>
        <p>The activity level is based on the total number of detections. Low activity indicates minimal presence,
            moderate activity indicates a typical amount, and high activity suggests increased activity.</p>
    </div>

    <h2>Detailed Activity Log</h2>
    <p>Click <a href="{{ url_for('show_full_log') }}" style="color: blue;">here</a> to view the detailed activity log
        for today. This log provides a comprehensive list of all detections recorded today.</p>

    <h2>Graph of Friend and Pest Occurrences</h2>
    <div class="chart-container">
        <div id="activityChart"></div>
    </div>

</div>

<!-- Load Plotly.js -->
<!-- Load Plotly.js -->
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script>
    var friendCounts = JSON.parse('{{ friend_counts|tojson|safe }}');
    var pestCounts = JSON.parse('{{ pest_counts|tojson|safe }}');

    var friendLabels = Object.keys(friendCounts);
    var pestLabels = Object.keys(pestCounts);

    var friendData = Object.values(friendCounts);
    var pestData = Object.values(pestCounts);

    var trace1 = {
        x: friendLabels,
        y: friendData,
        type: 'bar', // Change to bar chart
        name: 'Friends',
        marker: { color: 'rgba(75, 192, 192, 1)' }
    };

    var trace2 = {
        x: pestLabels,
        y: pestData,
        type: 'bar', // Change to bar chart
        name: 'Pests',
        marker: { color: 'rgba(255, 99, 132, 1)' }
    };

    var data = [trace1, trace2];

    var layout = {
        title: 'Friend and Pest Occurrences',
        xaxis: { title: 'Type' },
        yaxis: { title: 'Number of Detections' },
        barmode: 'group', // Optional: group bars by type
        margin: { t: 40 }
    };

    Plotly.newPlot('activityChart', data, layout);
</script>

{% endblock %}